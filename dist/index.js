(()=>{"use strict";(()=>{function t(t){return t.getContext("2d")}function i(t,i,e){t.width=i,t.height=e}function e(t,i,e){t.clearRect(0,0,i,e)}function n(t,i,e=!0,n=!0){if(t>i||i<t)throw new Error("Unexpected error occured in the passed argument values: min > max or max < min");const o=e&&!n,a=!e&&n;return e&&n?Math.floor(Math.random()*(i-t+1))+t:o?Math.floor(Math.random()*(i-t))+t:a?Math.floor(Math.random()*(i-t))+t+1:Math.floor(Math.random()*(i-t-1))+t+1}class o{constructor(t,i,e,o,a,r,s,h=0){this.context=t,this.width=i,this.height=e,this.originX=o,this.originY=a,this.color=r;this.width>window.innerWidth||this.height>window.innerHeight?(this.x=this.originX,this.y=this.originY):(this.x=n(0,this.width),this.y=n(0,this.height)),this.gap=h,this.size=s-this.gap,this.vectorX=0,this.vectorY=0,this.mouseParticleDistanceX=0,this.mouseParticleDistanceY=0,this.mouseTotalDistance=0,this.force=0,this.angle=0,this.friction=.6*Math.random()+.15,this.ease=.2*Math.random()+.05}update(t,i,e=2e4){const{x:n,y:o}=this.context.canvas.getBoundingClientRect();this.mouseParticleDistanceX=t-this.x-n,this.mouseParticleDistanceY=i-this.y-o,this.mouseTotalDistance=Math.pow(this.mouseParticleDistanceX,2)+Math.pow(this.mouseParticleDistanceY,2);this.mouseTotalDistance<e&&(this.angle=Math.atan2(this.mouseParticleDistanceY,this.mouseParticleDistanceX),this.force=-1*e/this.mouseTotalDistance,this.vectorX=Math.cos(this.angle)*this.force,this.vectorY=Math.sin(this.angle)*this.force),this.vectorX*=this.friction,this.vectorY*=this.friction,this.x+=this.vectorX+(this.originX-this.x)*this.ease,this.y+=this.vectorY+(this.originY-this.y)*this.ease}draw(){this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.size,this.size)}}const{log:a,error:r,table:s,time:h,timeEnd:c,timeStamp:d,timeLog:l,assert:u,clear:f,count:g,countReset:v,group:m,groupCollapsed:p,groupEnd:x,trace:w,profile:y,profileEnd:D,warn:E,debug:M,info:L,dir:P,dirxml:R}=console;function _(t,i){var e;if(!i)return document.querySelector(t);return(null===(e=null==i?void 0:i.tagName)||void 0===e?void 0:e.includes("-"))?i.shadowRoot.querySelector(t):i.querySelector(t)}function X(t,i){t.classList.add(i)}function Y(t,i){t.classList.remove(i)}function b(t){return Array.from(t)}var F=function(t,i,e,n){return new(e||(e=Promise))((function(o,a){function r(t){try{h(n.next(t))}catch(t){a(t)}}function s(t){try{h(n.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(r,s)}h((n=n.apply(t,i||[])).next())}))};function T(t,i){const{type:e}=t;var n,o;return(n=e,o="/",n.split(o))[0]===i}function A(t){return new Promise(((i,e)=>{const n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",(()=>{const t=n.result;"string"!=typeof t?e("Error: Base64 string not found."):i(t)})),n.addEventListener("error",(()=>{e("Error: Failed to read audio file.")}))}))}var I=function(t,i,e,n){return new(e||(e=Promise))((function(o,a){function r(t){try{h(n.next(t))}catch(t){a(t)}}function s(t){try{h(n.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(r,s)}h((n=n.apply(t,i||[])).next())}))};const S=new Map;S.set("x",0),S.set("y",0),S.set("radius",2e4),document.addEventListener("mousemove",(function(t){S.set("x",t.x),S.set("y",t.y)})),a("Hello world!");const C=_(".index__input");C.addEventListener("change",(function(t){return I(this,void 0,void 0,(function*(){K();try{const i=t.currentTarget,e=yield function(t){return F(this,void 0,void 0,(function*(){try{const i=b(t.files);return 1===i.length?i[0]:i}catch(t){r({fileRetrievalError:t})}}))}(i);if(!T(e,"image"))throw X($,"invalid-img-upload"),"File uploaded is not an image!";const n=yield A(e);yield Q(n),it(),et(),tt(),ot(),nt()}catch(t){r("File upload error:",{fileUploadError:t})}finally{Y($,"dragging")}}))}));const $=_(".index__label");$.addEventListener("dragover",(function(t){t.preventDefault(),K(),X($,"dragging")})),$.addEventListener("dragleave",(function(t){t.preventDefault(),K(),Y($,"dragging")})),$.addEventListener("drop",(function(t){return I(this,void 0,void 0,(function*(){t.preventDefault(),a(t),K();try{const i=yield function(t){return F(this,void 0,void 0,(function*(){try{const i=b(t.dataTransfer.files);return 1===i.length?i[0]:i}catch(t){r({fileRetrievalError:t})}}))}(t);if(!i)throw X($,"invalid-drop"),"Data dropped is not a file!";if(!T(i,"image"))throw X($,"invalid-img-drop"),"File dropped is not an image!";a(i);const e=yield A(i);yield Q(e),it(),et(),tt(),ot(),nt()}catch(t){r("File drop error:",{fileDropError:t}),X($,"invalid-drop")}finally{Y($,"dragging")}}))}));const q=_(".index__image");let z={width:0,height:0,aspectRatio:0};const N=_("main"),H=_(".index__controls"),U=_(".index__delete-button");U.addEventListener("click",(function(){e(G,j.width,j.height),q.src="",C.value="",X(U,"hide"),at(),V.reset(),X(j,"hide"),X(H,"hide"),z={width:0,height:0,aspectRatio:0},i(j,0,0),Y($,"hide")}));const B=_("#pixel-resolution"),W=_("label[for=pixel-resolution]"),k=_("#mouse-radius"),O=_("label[for=mouse-radius]");B.addEventListener("input",(function(t){e(G,j.width,j.height);const i=Number(t.target.value);W.textContent=`Pixel resolution: ${i}px`,a("change",i),at(),V.reset(),V.createImage(i),ot()})),k.addEventListener("input",(function(t){const i=1e3*Number(t.target.value),e=(n=i,new Intl.NumberFormat(o,{maximumSignificantDigits:3}).format(n));var n,o;O.textContent=`Mouse radius: ${e}`,S.set("radius",i)})),a(k,W,B,O);const j=_(".index__canvas"),G=t(j);let J=0;function K(){Y($,"invalid-drop"),Y($,"invalid-img-drop"),Y($,"invalid-img-upload")}function Q(t){return I(this,void 0,void 0,(function*(){q.src=t,q.addEventListener("load",Z)}))}let V=new class{constructor(i,e){this.canvas=i,this.context=t(i),this.particlesArray=[],this.imageElement=e}createImage(t=8){this.context.drawImage(this.imageElement,0,0),this.pixelsData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.convertToPixels(t)}animatePixels(t,i,e=2e4){for(const n of this.particlesArray)n.update(t,i,e),n.draw()}convertToPixels(t=1){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(let i=0;i<this.pixelsData.height;i+=t)for(let e=0;e<this.pixelsData.width;e+=t){const n=4*e+4*i*this.pixelsData.width;if(this.pixelsData.data[n+3]<10)continue;const a=this.pixelsData.data[n+0],r=this.pixelsData.data[n+1],s=this.pixelsData.data[n+2],h=`rgb(${a}, ${r}, ${s})`,c=new o(this.context,this.canvas.width,this.canvas.height,e,i,h,t);this.particlesArray.push(c)}}reset(){this.particlesArray=[]}}(j,q);function Z(t){const{width:e,height:n}=t.currentTarget;z.width=e,z.height=n,z.aspectRatio=e/n;N.clientWidth<e||N.clientHeight<n?(a("Overflows!"),i(j,z.width,z.height)):i(j,z.width,z.height),function(t=1){V.createImage(t)}(13),a(V)}function tt(){Y(H,"hide")}function it(){Y($,"dragging"),X($,"hide")}function et(){Y(U,"hide")}function nt(){Y(j,"hide")}function ot(){e(G,j.width,j.height),V.animatePixels(S.get("x"),S.get("y"),S.get("radius")),J=requestAnimationFrame(ot)}function at(){cancelAnimationFrame(J)}window.addEventListener("resize",(function(t){a("changed width")}))})()})();