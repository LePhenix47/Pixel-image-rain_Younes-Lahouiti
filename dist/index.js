(()=>{"use strict";(()=>{function t(t){return t.getContext("2d")}function i(t,i,e){t.width=i,t.height=e}function e(t,i,e){t.clearRect(0,0,i,e)}class n{constructor(t,i,e,n,s,a,o,r,h,c=0){this.context=t,this.width=i,this.height=e,this.mouseX=n,this.mouseY=s,this.mouseRadius=2e4,this.originX=a,this.originY=o,this.color=r,this.x=Math.random()*this.width,this.y=Math.random()*this.height,this.gap=c,this.size=h-this.gap,this.vectorX=0,this.vectorY=0,this.mouseParticleDistanceX=0,this.mouseParticleDistanceY=0,this.mouseTotalDistance=0,this.force=0,this.angle=0,this.friction=.6*Math.random()+.15,this.ease=.2*Math.random()+.05}update(t,i){this.mouseParticleDistanceX=t-this.x,this.mouseParticleDistanceY=i-this.y,this.mouseTotalDistance=Math.pow(this.mouseParticleDistanceX,2)+Math.pow(this.mouseParticleDistanceY,2),this.force=-1*this.mouseRadius/this.mouseTotalDistance;this.mouseTotalDistance<this.mouseRadius&&(this.angle=Math.atan2(this.mouseParticleDistanceY,this.mouseParticleDistanceX),this.vectorX=Math.cos(this.angle)*this.force,this.vectorY=Math.sin(this.angle)*this.force),this.vectorX*=this.friction,this.vectorY*=this.friction,this.x+=this.vectorX+(this.originX-this.x)*this.ease,this.y+=this.vectorY+(this.originY-this.y)*this.ease}draw(){this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.size,this.size)}}const{log:s,error:a,table:o,time:r,timeEnd:h,timeStamp:c,timeLog:d,assert:l,clear:u,count:f,countReset:g,group:v,groupCollapsed:m,groupEnd:p,trace:x,profile:w,profileEnd:y,warn:D,debug:E,info:L,dir:P,dirxml:R}=console;function X(t,i){var e;if(!i)return document.querySelector(t);return(null===(e=null==i?void 0:i.tagName)||void 0===e?void 0:e.includes("-"))?i.shadowRoot.querySelector(t):i.querySelector(t)}function Y(t,i){t.classList.add(i)}function M(t,i){t.classList.remove(i)}function _(t){return Array.from(t)}var T=function(t,i,e,n){return new(e||(e=Promise))((function(s,a){function o(t){try{h(n.next(t))}catch(t){a(t)}}function r(t){try{h(n.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?s(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(o,r)}h((n=n.apply(t,i||[])).next())}))};function A(t,i){const{type:e}=t;var n,s;return(n=e,s="/",n.split(s))[0]===i}function F(t){return new Promise(((i,e)=>{const n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",(()=>{const t=n.result;"string"!=typeof t?e("Error: Base64 string not found."):i(t)})),n.addEventListener("error",(()=>{e("Error: Failed to read audio file.")}))}))}var b=function(t,i,e,n){return new(e||(e=Promise))((function(s,a){function o(t){try{h(n.next(t))}catch(t){a(t)}}function r(t){try{h(n.throw(t))}catch(t){a(t)}}function h(t){var i;t.done?s(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(o,r)}h((n=n.apply(t,i||[])).next())}))};const S=new Map;S.set("x",0),S.set("y",0),s("Hello world!");const q=X(".index__input");q.addEventListener("change",(function(t){return b(this,void 0,void 0,(function*(){N();try{const i=t.currentTarget,e=yield function(t){return T(this,void 0,void 0,(function*(){try{const i=_(t.files);return 1===i.length?i[0]:i}catch(t){a({fileRetrievalError:t})}}))}(i);if(!A(e,"image"))throw Y(z,"invalid-img-upload"),"File uploaded is not an image!";const n=yield F(e);yield j(n),K(),Q(),W(),V()}catch(t){a("File upload error:",{fileUploadError:t})}finally{M(z,"dragging")}}))}));const z=X(".index__label");z.addEventListener("dragover",(function(t){t.preventDefault(),N(),Y(z,"dragging")})),z.addEventListener("dragleave",(function(t){t.preventDefault(),N(),M(z,"dragging")})),z.addEventListener("drop",(function(t){return b(this,void 0,void 0,(function*(){t.preventDefault(),s(t),N();try{const i=yield function(t){return T(this,void 0,void 0,(function*(){try{const i=_(t.dataTransfer.files);return i.length<=1?i[0]:i}catch(t){a({fileRetrievalError:t})}}))}(t);if(!i)throw Y(z,"invalid-drop"),"Data dropped is not a file!";if(!A(i,"image"))throw Y(z,"invalid-img-drop"),"File dropped is not an image!";s(i);const e=yield F(i);yield j(e),K(),Q(),W(),V()}catch(t){a("File drop error:",{fileDropError:t}),Y(z,"invalid-drop")}finally{M(z,"dragging")}}))}));const I=X(".index__image"),$={width:0,height:0,aspectRatio:0},C=X("main"),U=X(".index__delete-button");U.addEventListener("click",(function(){e(B,k.width,k.height),I.src="",q.value="",Y(U,"hide"),cancelAnimationFrame(H),G.reset(),Y(k,"hide"),C.removeEventListener("mousemove",O),i(k,0,0),M(z,"hide")}));const k=X(".index__canvas"),B=t(k);let H=0;function N(){M(z,"invalid-drop"),M(z,"invalid-img-drop"),M(z,"invalid-img-upload")}function j(t){return b(this,void 0,void 0,(function*(){I.src=t,I.addEventListener("load",J)}))}let G=new class{constructor(i,e){this.canvas=i,this.context=t(i),this.particlesArray=[],this.imageElement=e,this.mouseX=0,this.mouseY=0}createImage(){this.context.drawImage(this.imageElement,0,0),this.pixelsData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.convertToPixels(20)}animatePixels(t,i){for(const e of this.particlesArray)e.update(t,i),e.draw()}convertToPixels(t=1){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(let i=0;i<this.pixelsData.height;i+=t)for(let e=0;e<this.pixelsData.width;e+=t){const s=4*e+4*i*this.pixelsData.width;if(this.pixelsData.data[s+3]<=0)continue;const a=this.pixelsData.data[s+0],o=this.pixelsData.data[s+1],r=this.pixelsData.data[s+2],h=`rgb(${a}, ${o}, ${r})`,c=new n(this.context,this.canvas.width,this.canvas.height,this.mouseX,this.mouseY,e,i,h,t);this.particlesArray.push(c)}}reset(){this.particlesArray=[]}}(k,I);function J(t){const{width:e,height:n}=t.currentTarget;$.width=e,$.height=n,$.aspectRatio=e/n,i(k,$.width,$.height),C.addEventListener("mousemove",O),s(G),G.createImage()}function K(){M(z,"dragging"),Y(z,"hide")}function O(t){S.set("x",t.x),S.set("y",t.y),s(S)}function Q(){M(U,"hide")}function V(){M(k,"hide")}function W(){e(B,k.width,k.height),G.animatePixels(S.get("x"),S.get("y")),H=requestAnimationFrame(W)}window.addEventListener("resize",(function(t){s("changed width")}))})()})();